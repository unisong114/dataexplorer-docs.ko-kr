---
title: 캐시 정책 (핫 및 콜드 캐시)-Azure 데이터 탐색기
description: 이 문서에서는 Azure 데이터 탐색기의 캐시 정책 (핫 및 콜드 캐시)에 대해 설명 합니다.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/19/2020
ms.openlocfilehash: af224c630cb835d190b8fd6655a6d42f7fd7fee9
ms.sourcegitcommit: d79d3aa9aaa70cd23e3107ef12296159322e1eb5
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/20/2020
ms.locfileid: "86475612"
---
# <a name="cache-policy-hot-and-cold-cache"></a>캐시 정책(핫 및 콜드 캐시) 

Azure 데이터 탐색기는 실제 처리 (예: Azure Compute) 노드와는 다른 수집 데이터를 신뢰할 수 있는 저장소 (가장 일반적으로 Azure Blob Storage)에 저장 합니다. 해당 데이터에 대 한 쿼리 속도를 높이기 위해 Azure 데이터 탐색기는 해당 데이터 또는 그 일부를 처리 노드, SSD 또는 RAM에도 캐시 합니다. Azure 데이터 탐색기에는 캐시할 데이터 개체를 지능적으로 결정 하도록 설계 된 정교한 캐시 메커니즘이 포함 되어 있습니다. 캐시를 사용 하면 Azure 데이터 탐색기에서 사용 하는 데이터 아티팩트를 설명할 수 있으므로 더 중요 한 데이터가 우선적으로 적용 될 수 있습니다. 예: 열 인덱스 및 열 데이터 분할

모든 수집 데이터를 캐시 하는 경우 최상의 쿼리 성능을 얻을 수 있습니다. 경우에 따라 특정 데이터를 로컬 SSD 저장소에서 "웜"으로 유지 하는 비용이 정당화 되지 않습니다.
예를 들어 많은 팀이 드물게 액세스 하는 오래 된 로그 레코드의 중요도가 낮은 것으로 간주 합니다.
이 데이터를 쿼리 하는 경우 비용이 청구 되는 것이 아니라 모든 시간을 유지 하는 것이 좋습니다.

Azure 데이터 탐색기 캐시는 고객이 **핫 데이터 캐시** 와 **콜드 데이터 캐시**를 구분 하는 데 사용할 수 있는 세부적인 **캐시 정책을** 제공 합니다. Azure 데이터 탐색기 캐시는 핫 데이터 캐시 범주에 해당 하는 모든 데이터를 로컬 SSD (또는 RAM)에서 핫 데이터 캐시의 정의 된 크기로 유지 하려고 합니다. 나머지 로컬 SSD 공간은 핫으로 분류 되지 않은 데이터를 저장 하는 데 사용 됩니다. 이 디자인의 유용한 한 가지 의미는 신뢰할 수 있는 저장소에서 많은 콜드 데이터를 로드 하는 쿼리가 핫 데이터 캐시에서 데이터를 제거 하지 않는다는 것입니다. 따라서 핫 데이터 캐시에 있는 데이터와 관련 된 쿼리에는 상당한 영향을 주지 않습니다.

핫 캐시 정책 설정의 주요 의미는 다음과 같습니다.
* **비용**: 신뢰할 수 있는 저장소의 비용은 로컬 SSD 보다 크게 낮출 수 있습니다. 현재 Azure에서 약 45 시간이 저렴 합니다.
* **성능**: 로컬 SSD, 특히 대량의 데이터를 검색 하는 범위 쿼리에 대해 데이터를 더 빨리 쿼리 합니다.  

캐시 정책 [명령을](cache-policy.md) 사용 하 여 캐시 정책을 관리 합니다.

> [!TIP]
>Azure 데이터 탐색기는 중간 결과 집합을 사용 하 여 클러스터의 총 RAM을 맞추는 임시 쿼리에 대해 설계 되었습니다.
>SSD와 같이 영구 저장소에 중간 결과를 저장 하려는 지도 감소와 같은 대량 작업의 경우 연속 내보내기 기능을 사용 합니다. 이 기능을 사용 하면 HDInsight 또는 Azure Databricks와 같은 서비스를 사용 하 여 장기 실행 일괄 처리 쿼리를 수행할 수 있습니다.
 
## <a name="how-cache-policy-is-applied"></a>캐시 정책이 적용 되는 방법

데이터가 Azure 데이터 탐색기로 수집 시스템은 수집 된 날짜 및 시간과 생성 된 익스텐트의 추적을 유지 합니다. 익스텐트의 수집 날짜 및 시간 값 (또는 익스텐트가 여러 기존 범위에서 빌드된 경우 최대값)은 캐시 정책을 평가 하는 데 사용 됩니다.

> [!NOTE]
> 수집 속성을 사용 하 여 수집 날짜 및 시간에 대 한 값을 지정할 수 있습니다 `creationTime` .

기본적으로 유효 정책은입니다 `null` . 즉, 모든 데이터가 **핫**으로 간주 됩니다.
`null`테이블 수준이 아닌 정책은 데이터베이스 수준 정책을 재정의 합니다.

## <a name="scoping-queries-to-hot-cache"></a>핫 캐시로 쿼리 범위 지정

Kusto는 핫 캐시 데이터만으로 범위가 지정 된 쿼리를 지원 합니다.

> [!NOTE]
> 데이터 범위 지정은 테이블과 같은 캐싱 정책을 지 원하는 엔터티에만 적용 됩니다. 외부 테이블과 같은 다른 엔터티에 대해서는 무시 됩니다.

다음과 같은 몇 가지 쿼리 가능성이 있습니다.
* 이라는 클라이언트 요청 속성을 `query_datascope` 쿼리에 추가 합니다.
   가능한 값은 `default` , `all` 및 `hotcache` 입니다.
* `set`쿼리 텍스트에서 문을 사용 `set query_datascope='...'` 합니다.
   가능한 값은 클라이언트 요청 속성의 경우와 동일 합니다.
* `datascope=...`쿼리 본문에서 테이블 참조 바로 뒤에 텍스트를 추가 합니다. 
   가능한 값은 `all` 및 `hotcache`입니다.

`default`값은 쿼리가 모든 데이터를 포함 해야 함을 결정 하는 클러스터 기본 설정의 사용을 나타냅니다.

서로 다른 메서드 간에 차이가 있으면가 `set` 클라이언트 요청 속성 보다 우선 합니다. 테이블 참조 값을 지정 하는 것이 두 가지 보다 우선 합니다.

예를 들어 다음 쿼리에서 모든 테이블 참조는 모든 데이터로 범위가 지정 된 "T"에 대 한 두 번째 참조를 제외 하 고는 핫 캐시 데이터만 사용 합니다.

```kusto
set query_datascope="hotcache";
T | union U | join (T datascope=all | where Timestamp < ago(365d) on X
```

## <a name="cache-policy-vs-retention-policy"></a>캐시 정책 vs 보존 정책

캐시 정책은 [보존 정책과](./retentionpolicy.md)독립적입니다. 
- 캐시 정책은 리소스의 우선 순위를 지정 하는 방법을 정의 합니다. 중요 한 데이터에 대 한 쿼리는 중요 하지 않은 데이터에 대 한 쿼리의 영향을 더 빠르고 방어할 수 있습니다.
- 보존 정책은 테이블/데이터베이스에서 쿼리 가능한 데이터의 범위 (특히)를 정의 `SoftDeletePeriod` 합니다.

예상 쿼리 패턴에 따라 비용과 성능 간에 최적의 균형을 이루기 위해이 정책을 구성 합니다.

예제:
* `SoftDeletePeriod`= 56d
* `hot cache policy`= 28d

이 예제에서 데이터의 마지막 28 일은 클러스터 SSD에 있으며 추가 28 일의 데이터가 Azure blob 저장소에 저장 됩니다.
전체 56 일 데이터에 대해 쿼리를 실행할 수 있습니다.
 
